<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pagamento - Visitante UNINASSAU S.A</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/visitante.css">
</head>
<body class="bg-light">

    <nav class="navbar navbar-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">
                <img src="https://images.seeklogo.com/logo-png/47/2/uninassau-logo-png_seeklogo-475645.png" width="80" alt="Logo">
                <span class="ms-2">Estacionamento UNINASSAU</span>
            </a>
            <a href="index.html" class="btn btn-outline-secondary">Voltar ao Início</a>
        </div>
    </nav>

    <div class="container mt-5 mb-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                
                <!-- Seção de Entrada de Ticket -->
                <div class="card shadow-sm mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="fas fa-ticket-alt me-2"></i> Consultar Ticket de Estacionamento</h5>
                    </div>
                    <div class="card-body">
                        <p class="text-muted">Digite o código do seu ticket para verificar o tempo de permanência e valor a pagar.</p>
                        
                        <form id="formTicket">
                            <div class="mb-3">
                                <label for="codigoTicket" class="form-label"><strong>Código do Ticket</strong></label>
                                <input 
                                    type="text" 
                                    class="form-control form-control-lg" 
                                    id="codigoTicket" 
                                    placeholder="Ex: TICK-2025-00001" 
                                    required
                                    maxlength="20">
                                <small class="text-muted">Digite exatamente como aparece no seu ticket</small>
                            </div>
                            
                            <button type="button" class="btn btn-primary w-100 btn-lg" id="btnConsultarTicket">
                                <i class="fas fa-search me-2"></i> Consultar Ticket
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Seção de Informações do Ticket (Oculta por padrão) -->
                <div id="ticketInfo" style="display: none;">
                    <div class="ticket-container">
                        <div class="text-center mb-3">
                            <h2><i class="fas fa-check-circle"></i> Ticket Localizado</h2>
                            <p class="mb-0">RF-012: Controle de Acesso Visitante</p>
                        </div>

                        <div class="status-badge">
                            <i class="fas fa-car me-2"></i> VEÍCULO ESTACIONADO
                        </div>

                        <!-- Informações Básicas -->
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Código do Ticket:</label>
                                <div class="value" id="displayCodigoTicket">TICK-2025-00001</div>
                            </div>
                            <div class="info-item">
                                <label>Data de Entrada:</label>
                                <div class="value" id="displayDataEntrada">23/11/2025</div>
                            </div>
                            <div class="info-item">
                                <label>Horário de Entrada:</label>
                                <div class="value" id="displayHoraEntrada">14:30</div>
                            </div>
                            <div class="info-item">
                                <label>Tempo de Permanência:</label>
                                <div class="value" id="displayTempoEstacionado">2h 45min</div>
                            </div>
                        </div>

                        <!-- Valor a Pagar -->
                        <div class="valor-pagar">
                            <h3>Valor a Pagar</h3>
                            <div class="valor-total" id="displayValorTotal">R$ 13,75</div>
                            <small style="opacity: 0.9;">Taxa: R$ 5,00/hora (Visitante)</small>
                        </div>

                        <!-- Detalhes de Cálculo -->
                        <div class="ticket-info">
                            <strong>Cálculo do Valor:</strong><br>
                            <small id="displayDetalheCálculo">2h 45min × R$ 5,00/h = R$ 13,75</small>
                        </div>

                        <!-- Botões de Ação -->
                        <div class="d-grid gap-2 mt-4">
                            <button type="button" class="btn btn-pagar btn-lg" id="btnRealizarPagamento">
                                <i class="fas fa-credit-card me-2"></i> Realizar Pagamento
                            </button>
                            <button type="button" class="btn btn-outline-light" id="btnNovoTicket">
                                <i class="fas fa-redo me-2"></i> Consultar Outro Ticket
                            </button>
                        </div>
                    </div>

                    <!-- Mensagem de Sucesso -->
                    <div class="success-message" id="mensagemSucesso">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-check-circle me-3" style="font-size: 1.5rem;"></i>
                            <div>
                                <strong>Pagamento Realizado com Sucesso!</strong><br>
                                <small>Você pode agora se deslocar para a cancela de saída.</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mensagem de Erro -->
                <div class="error-message" id="mensagemErro">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-exclamation-circle me-3" style="font-size: 1.5rem;"></i>
                        <div>
                            <strong>Ticket Não Encontrado</strong><br>
                            <small id="textoErro">Verifique o código e tente novamente.</small>
                        </div>
                    </div>
                </div>

                <!-- Informações Adicionais -->
                <div class="card shadow-sm mt-4 bg-info bg-opacity-10">
                    <div class="card-body">
                        <h6 class="card-title"><i class="fas fa-info-circle me-2"></i> Informações Importantes</h6>
                        <ul class="mb-0 small">
                            <li>O pagamento é obrigatório para liberar a cancela de saída</li>
                            <li>Taxa de estacionamento para visitante: R$ 5,00 por hora</li>
                            <li>Frações de 15 minutos são cobradas como hora cheia</li>
                            <li>Aceitamos PIX, Cartão de Crédito e Dinheiro</li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <footer class="bg-light text-center text-lg-start mt-5">
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.05);">
            © 2025 Estacionamento UNINASSAU S.A - Versão 1.0 (beta)
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Simulação de dados de tickets
        const ticketsDatabase = {
            'TICK-2025-00001': {
                dataEntrada: '23/11/2025',
                horaEntrada: '14:30',
                horaAtual: '17:15', // Simula hora atual
                valorHora: 5.00
            },
            'TICK-2025-00002': {
                dataEntrada: '23/11/2025',
                horaEntrada: '12:00',
                horaAtual: '17:15',
                valorHora: 5.00
            },
            'TICK-2025-00003': {
                dataEntrada: '23/11/2025',
                horaEntrada: '15:45',
                horaAtual: '17:15',
                valorHora: 5.00
            }
        };

        // Função para calcular tempo de permanência
        function calcularTempoEstacionamento(horaEntrada, horaAtual) {
            const [entHoras, entMinutos] = horaEntrada.split(':').map(Number);
            const [atualHoras, atualMinutos] = horaAtual.split(':').map(Number);
            
            let minutos = atualMinutos - entMinutos;
            let horas = atualHoras - entHoras;
            
            if (minutos < 0) {
                minutos += 60;
                horas -= 1;
            }
            
            // Arredondar para a hora cheia se houver minutos
            if (minutos > 0) {
                horas += 1;
            }
            
            return { horas, minutos: 0 };
        }

        // Função para calcular valor total
        function calcularValorTotal(horas, valorHora) {
            return (horas * valorHora).toFixed(2);
        }

        // Evento do botão Consultar
        document.getElementById('btnConsultarTicket').addEventListener('click', function() {
            const codigo = document.getElementById('codigoTicket').value.trim().toUpperCase();
            const ticketInfoDiv = document.getElementById('ticketInfo');
            const erroDiv = document.getElementById('mensagemErro');
            const sucessoDiv = document.getElementById('mensagemSucesso');
            
            // Limpar mensagens anteriores
            erroDiv.classList.remove('show');
            sucessoDiv.classList.remove('show');
            
            if (ticketsDatabase[codigo]) {
                const ticket = ticketsDatabase[codigo];
                const tempo = calcularTempoEstacionamento(ticket.horaEntrada, ticket.horaAtual);
                const valor = calcularValorTotal(tempo.horas, ticket.valorHora);
                
                // Atualizar campos de exibição
                document.getElementById('displayCodigoTicket').textContent = codigo;
                document.getElementById('displayDataEntrada').textContent = ticket.dataEntrada;
                document.getElementById('displayHoraEntrada').textContent = ticket.horaEntrada;
                document.getElementById('displayTempoEstacionado').textContent = 
                    `${tempo.horas}h ${tempo.minutos}min`;
                document.getElementById('displayValorTotal').textContent = `R$ ${valor}`;
                document.getElementById('displayDetalheCálculo').textContent = 
                    `${tempo.horas}h ${tempo.minutos}min × R$ ${ticket.valorHora.toFixed(2)}/h = R$ ${valor}`;
                
                // Mostrar informações do ticket
                ticketInfoDiv.style.display = 'block';
                window.scrollTo({ top: ticketInfoDiv.offsetTop - 100, behavior: 'smooth' });
            } else {
                document.getElementById('textoErro').textContent = 
                    'O código "' + codigo + '" não foi encontrado em nosso sistema. Verifique e tente novamente.';
                erroDiv.classList.add('show');
                ticketInfoDiv.style.display = 'none';
            }
        });

        // Permitir buscar com Enter
        document.getElementById('codigoTicket').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                document.getElementById('btnConsultarTicket').click();
            }
        });

        // Evento do botão Pagar
        document.getElementById('btnRealizarPagamento').addEventListener('click', function() {
            const sucessoDiv = document.getElementById('mensagemSucesso');
            const ticketInfoDiv = document.getElementById('ticketInfo');
            
            // Desabilitar botão durante processamento
            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Processando...';
            
            // Simular processamento
            setTimeout(() => {
                sucessoDiv.classList.add('show');
                this.disabled = false;
                this.innerHTML = '<i class="fas fa-credit-card me-2"></i> Realizar Pagamento';
                
                // Scroll para mensagem de sucesso
                window.scrollTo({ top: ticketInfoDiv.offsetTop + 500, behavior: 'smooth' });
            }, 2000);
        });

        // Evento do botão Novo Ticket
        document.getElementById('btnNovoTicket').addEventListener('click', function() {
            document.getElementById('codigoTicket').value = '';
            document.getElementById('ticketInfo').style.display = 'none';
            document.getElementById('mensagemErro').classList.remove('show');
            document.getElementById('mensagemSucesso').classList.remove('show');
            document.getElementById('codigoTicket').focus();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>